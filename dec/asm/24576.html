<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 24576</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="23296.html">23296</a></span></td>
<td class="up">Up: <a href="../maps/all.html#24576">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="24699.html">24699</a></span></td>
</tr>
</table>
<div class="description">24576: Scroll the screen right one column</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="25810.html">25810</a>.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24576"></span>24576</td>
<td class="bytes-0"></td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24577"></span>24577</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,22558</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the rightmost end of the top row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24580"></span>24580</td>
<td class="bytes-0"></td>
<td class="instruction">LD DE,22559</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24583"></span>24583</td>
<td class="bytes-0"></td>
<td class="instruction">LD BC,31</td>
<td class="comment-11" rowspan="1">We need to scroll 31 attribute bytes at a time</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24586"></span>24586</td>
<td class="bytes-0"></td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24587"></span>24587</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,16414</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the rightmost end of the top row of pixels on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24590"></span>24590</td>
<td class="bytes-0"></td>
<td class="instruction">LD DE,16415</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24593"></span>24593</td>
<td class="bytes-0"></td>
<td class="instruction">LD BC,31</td>
<td class="comment-11" rowspan="1">We need to scroll 31 display file bytes at a time</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24596"></span>24596</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,21</td>
<td class="comment-11" rowspan="1">There are 21 rows of character squares to scroll</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24598"></span>24598</td>
<td class="bytes-0"></td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24599"></span>24599</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,8</td>
<td class="comment-11" rowspan="1">Each row of character squares contains 8 rows of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24601"></span>24601</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24602"></span>24602</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24603"></span>24603</td>
<td class="bytes-0"></td>
<td class="instruction">LDDR</td>
<td class="comment-11" rowspan="1">Scroll a row of pixels right one column</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24605"></span>24605</td>
<td class="bytes-0"></td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24606"></span>24606</td>
<td class="bytes-0"></td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24607"></span>24607</td>
<td class="bytes-0"></td>
<td class="instruction">LD C,31</td>
<td class="comment-11" rowspan="1"><span class="register">BC</span>=31</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24609"></span>24609</td>
<td class="bytes-0"></td>
<td class="instruction">INC H</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the next row of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24610"></span>24610</td>
<td class="bytes-0"></td>
<td class="instruction">INC D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24611"></span>24611</td>
<td class="bytes-0"></td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Next row in this block of 8x32</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24612"></span>24612</td>
<td class="bytes-0"></td>
<td class="instruction">JR NZ,24601</td>
<td class="comment-11" rowspan="1">Jump back until this 8x32 pixel block has been scrolled</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24614"></span>24614</td>
<td class="bytes-0"></td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24615"></span>24615</td>
<td class="bytes-0"></td>
<td class="instruction">LDDR</td>
<td class="comment-11" rowspan="1">Scroll a row of attribute bytes right one column</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24617"></span>24617</td>
<td class="bytes-0"></td>
<td class="instruction">LD C,63</td>
<td class="comment-11" rowspan="5">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the rightmost end of the next row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24619"></span>24619</td>
<td class="bytes-0"></td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24620"></span>24620</td>
<td class="bytes-0"></td>
<td class="instruction">EX DE,HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24621"></span>24621</td>
<td class="bytes-0"></td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24622"></span>24622</td>
<td class="bytes-0"></td>
<td class="instruction">EX DE,HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24623"></span>24623</td>
<td class="bytes-0"></td>
<td class="instruction">LD C,31</td>
<td class="comment-11" rowspan="1"><span class="register">BC'</span>=31</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24625"></span>24625</td>
<td class="bytes-0"></td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24626"></span>24626</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,32</td>
<td class="comment-11" rowspan="6">Point <span class="register">HL</span> and <span class="register">DE</span> at the rightmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24628"></span>24628</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24629"></span>24629</td>
<td class="bytes-0"></td>
<td class="instruction">LD E,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24630"></span>24630</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,32</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24632"></span>24632</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24633"></span>24633</td>
<td class="bytes-0"></td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24634"></span>24634</td>
<td class="bytes-0"></td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24635"></span>24635</td>
<td class="bytes-0"></td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Next row of character squares</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24636"></span>24636</td>
<td class="bytes-0"></td>
<td class="instruction">JR Z,24654</td>
<td class="comment-11" rowspan="1">Exit this loop if all 21 rows have been scrolled right</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24638"></span>24638</td>
<td class="bytes-0"></td>
<td class="instruction">CP 13</td>
<td class="comment-11" rowspan="1">Have we reached the middle third of the screen?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24640"></span>24640</td>
<td class="bytes-0"></td>
<td class="instruction">JR Z,24598</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24642"></span>24642</td>
<td class="bytes-0"></td>
<td class="instruction">CP 5</td>
<td class="comment-11" rowspan="1">Have we reached the bottom third of the screen?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24644"></span>24644</td>
<td class="bytes-0"></td>
<td class="instruction">JR Z,24598</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24646"></span>24646</td>
<td class="bytes-0"></td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24647"></span>24647</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="4">Point <span class="register">HL</span> and <span class="register">DE</span> at the rightmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24648"></span>24648</td>
<td class="bytes-0"></td>
<td class="instruction">SUB 8</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24650"></span>24650</td>
<td class="bytes-0"></td>
<td class="instruction">LD H,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24651"></span>24651</td>
<td class="bytes-0"></td>
<td class="instruction">LD D,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24652"></span>24652</td>
<td class="bytes-0"></td>
<td class="instruction">JR 24599</td>
<td class="comment-11" rowspan="1">Jump back to deal with the next row of character squares</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="24654"></span>
<div class="comments">
<div class="paragraph">
The 21 rows of character squares have been scrolled one place to the right. Now the leftmost column needs to be filled.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24654"></span>24654</td>
<td class="bytes-0"></td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24655"></span>24655</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,22528</td>
<td class="comment-11" rowspan="3">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the attribute file and display file addresses for the top left of the screen, and set <span class="register">BC'</span>=32; however, these values are not used</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24658"></span>24658</td>
<td class="bytes-0"></td>
<td class="instruction">LD DE,16384</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24661"></span>24661</td>
<td class="bytes-0"></td>
<td class="instruction">INC C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24662"></span>24662</td>
<td class="bytes-0"></td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24663"></span>24663</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,(32512)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=leftmost column of the skool on-screen (0-64)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24666"></span>24666</td>
<td class="bytes-0"></td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="2">We are scrolling one column right</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24667"></span>24667</td>
<td class="bytes-0"></td>
<td class="instruction">LD (32512),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="24670"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="24731.html">24731</a> with <span class="register">A</span> holding the x-coordinate of the rightmost column of the skool on-screen (31-95).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24670"></span>24670</td>
<td class="bytes-0"></td>
<td class="instruction">LD E,A</td>
<td class="comment-11" rowspan="1"><span class="register">E</span>=X (x-coordinate of the far left or far right column of the skool currently on-screen)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24671"></span>24671</td>
<td class="bytes-0"></td>
<td class="instruction">LD D,152</td>
<td class="comment-11" rowspan="1"><span class="register">D</span>=Y (this is the y-coordinate of the top row of the screen)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24673"></span>24673</td>
<td class="bytes-0"></td>
<td class="instruction">LD B,21</td>
<td class="comment-11" rowspan="1">There are 21 rows on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24675"></span>24675</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24676"></span>24676</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24677"></span>24677</td>
<td class="bytes-0"></td>
<td class="instruction">CALL <a href="24843.html">24843</a></td>
<td class="comment-11" rowspan="1">Print the character square at (X,Y)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24680"></span>24680</td>
<td class="bytes-0"></td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24681"></span>24681</td>
<td class="bytes-0"></td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24682"></span>24682</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="6">Point <span class="register">HL</span> at the attribute file address corresponding to the skool coordinates (X,Y)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24683"></span>24683</td>
<td class="bytes-0"></td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24684"></span>24684</td>
<td class="bytes-0"></td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24685"></span>24685</td>
<td class="bytes-0"></td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24686"></span>24686</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,79</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24688"></span>24688</td>
<td class="bytes-0"></td>
<td class="instruction">LD H,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24689"></span>24689</td>
<td class="bytes-0"></td>
<td class="instruction">SET 7,E</td>
<td class="comment-11" rowspan="1">Point <span class="register">DE</span> at the attribute byte for the skool coordinates (X,Y)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24691"></span>24691</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-11" rowspan="1">Pick the attribute byte up in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24692"></span>24692</td>
<td class="bytes-0"></td>
<td class="instruction">RES 7,E</td>
<td class="comment-11" rowspan="1">Restore the skool coordinates (X,Y) to <span class="register">DE</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24694"></span>24694</td>
<td class="bytes-0"></td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="1">Poke the attribute byte onto the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24695"></span>24695</td>
<td class="bytes-0"></td>
<td class="instruction">INC D</td>
<td class="comment-11" rowspan="1">Next row (Y) of the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24696"></span>24696</td>
<td class="bytes-0"></td>
<td class="instruction">DJNZ 24675</td>
<td class="comment-11" rowspan="1">Jump back until all 21 rows are done</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24698"></span>24698</td>
<td class="bytes-0"></td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="23296.html">23296</a></span></td>
<td class="up">Up: <a href="../maps/all.html#24576">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="24699.html">24699</a></span></td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20190614</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2019 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 7.2.</div>
<div><a href="../../asm/6000.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>