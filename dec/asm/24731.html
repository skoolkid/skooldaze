<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 24731</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="24699.html">24699</a>
</td>
<td class="up">Up: <a href="../maps/all.html#24731">Map</a></td>
<td class="next">
Next: <a href="24825.html">24825</a>
</td>
</tr>
</table>
<div class="description">24731: Scroll the screen left one column</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="25820.html">25820</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="24731"></span>24731</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24732"></span>24732</td>
<td class="instruction">LD HL,22529</td>
<td class="comment-1" rowspan="2">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the leftmost end of the top row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="address-1"><span id="24735"></span>24735</td>
<td class="instruction">LD DE,22528</td>
</tr>
<tr>
<td class="address-1"><span id="24738"></span>24738</td>
<td class="instruction">LD BC,31</td>
<td class="comment-1" rowspan="1">We need to scroll 31 attribute bytes at a time</td>
</tr>
<tr>
<td class="address-1"><span id="24741"></span>24741</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24742"></span>24742</td>
<td class="instruction">LD HL,16385</td>
<td class="comment-1" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the leftmost end of the top row of pixels on the screen</td>
</tr>
<tr>
<td class="address-1"><span id="24745"></span>24745</td>
<td class="instruction">LD DE,16384</td>
</tr>
<tr>
<td class="address-1"><span id="24748"></span>24748</td>
<td class="instruction">LD BC,31</td>
<td class="comment-1" rowspan="1">We need to scroll 31 display file bytes at a time</td>
</tr>
<tr>
<td class="address-1"><span id="24751"></span>24751</td>
<td class="instruction">LD A,21</td>
<td class="comment-1" rowspan="1">There are 21 rows of character squares to scroll</td>
</tr>
<tr>
<td class="address-2"><span id="24753"></span>24753</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="24754"></span>24754</td>
<td class="instruction">LD A,8</td>
<td class="comment-1" rowspan="1">Each row of character squares contains 8 rows of pixels</td>
</tr>
<tr>
<td class="address-2"><span id="24756"></span>24756</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24757"></span>24757</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24758"></span>24758</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1">Scroll a row of pixels left one column</td>
</tr>
<tr>
<td class="address-1"><span id="24760"></span>24760</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24761"></span>24761</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24762"></span>24762</td>
<td class="instruction">INC D</td>
<td class="comment-1" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the next row of pixels</td>
</tr>
<tr>
<td class="address-1"><span id="24763"></span>24763</td>
<td class="instruction">INC H</td>
</tr>
<tr>
<td class="address-1"><span id="24764"></span>24764</td>
<td class="instruction">LD C,31</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=31</td>
</tr>
<tr>
<td class="address-1"><span id="24766"></span>24766</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Next row in this block of 8x32</td>
</tr>
<tr>
<td class="address-1"><span id="24767"></span>24767</td>
<td class="instruction">JR NZ,24756</td>
<td class="comment-1" rowspan="1">Jump back until this 8x32 pixel block has been scrolled</td>
</tr>
<tr>
<td class="address-1"><span id="24769"></span>24769</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24770"></span>24770</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1">Scroll a row of attribute bytes left one column</td>
</tr>
<tr>
<td class="address-1"><span id="24772"></span>24772</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="2">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the leftmost end of the next row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="address-1"><span id="24773"></span>24773</td>
<td class="instruction">INC DE</td>
</tr>
<tr>
<td class="address-1"><span id="24774"></span>24774</td>
<td class="instruction">LD C,31</td>
<td class="comment-1" rowspan="1"><span class="register">BC'</span>=31</td>
</tr>
<tr>
<td class="address-1"><span id="24776"></span>24776</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24777"></span>24777</td>
<td class="instruction">LD A,32</td>
<td class="comment-1" rowspan="6">Point <span class="register">HL</span> and <span class="register">DE</span> at the leftmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="address-1"><span id="24779"></span>24779</td>
<td class="instruction">ADD A,E</td>
</tr>
<tr>
<td class="address-1"><span id="24780"></span>24780</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="address-1"><span id="24781"></span>24781</td>
<td class="instruction">LD A,32</td>
</tr>
<tr>
<td class="address-1"><span id="24783"></span>24783</td>
<td class="instruction">ADD A,L</td>
</tr>
<tr>
<td class="address-1"><span id="24784"></span>24784</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="address-1"><span id="24785"></span>24785</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24786"></span>24786</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Next row of character squares</td>
</tr>
<tr>
<td class="address-1"><span id="24787"></span>24787</td>
<td class="instruction">JR Z,24805</td>
<td class="comment-1" rowspan="1">Exit this loop if all 21 rows have been scrolled left</td>
</tr>
<tr>
<td class="address-1"><span id="24789"></span>24789</td>
<td class="instruction">CP 5</td>
<td class="comment-1" rowspan="1">Have we reached the bottom third of the screen?</td>
</tr>
<tr>
<td class="address-1"><span id="24791"></span>24791</td>
<td class="instruction">JR Z,24753</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="24793"></span>24793</td>
<td class="instruction">CP 13</td>
<td class="comment-1" rowspan="1">Have we reached the middle third of the screen?</td>
</tr>
<tr>
<td class="address-1"><span id="24795"></span>24795</td>
<td class="instruction">JR Z,24753</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="24797"></span>24797</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24798"></span>24798</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="4">Point <span class="register">HL</span> and <span class="register">DE</span> at the leftmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="address-1"><span id="24799"></span>24799</td>
<td class="instruction">SUB 8</td>
</tr>
<tr>
<td class="address-1"><span id="24801"></span>24801</td>
<td class="instruction">LD H,A</td>
</tr>
<tr>
<td class="address-1"><span id="24802"></span>24802</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="address-1"><span id="24803"></span>24803</td>
<td class="instruction">JR 24754</td>
<td class="comment-1" rowspan="1">Jump back to deal with the next row of character squares</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="24805"></span>
<div class="comments">
<div class="paragraph">
The 21 rows of character squares have been scrolled one place to the left. Now the rightmost column needs to be filled.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="24805"></span>24805</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24806"></span>24806</td>
<td class="instruction">LD HL,22559</td>
<td class="comment-1" rowspan="3">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the attribute file and display file addresses for the top right of the screen, and set <span class="register">BC'</span>=32; however, these values are not used</td>
</tr>
<tr>
<td class="address-1"><span id="24809"></span>24809</td>
<td class="instruction">LD DE,16415</td>
</tr>
<tr>
<td class="address-1"><span id="24812"></span>24812</td>
<td class="instruction">INC C</td>
</tr>
<tr>
<td class="address-1"><span id="24813"></span>24813</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="24814"></span>24814</td>
<td class="instruction">LD A,(32512)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=leftmost column of the skool on-screen (0-64)</td>
</tr>
<tr>
<td class="address-1"><span id="24817"></span>24817</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="2">We are scrolling one column left</td>
</tr>
<tr>
<td class="address-1"><span id="24818"></span>24818</td>
<td class="instruction">LD (32512),A</td>
</tr>
<tr>
<td class="address-1"><span id="24821"></span>24821</td>
<td class="instruction">ADD A,C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=rightmost column of the skool on-screen (31-95)</td>
</tr>
<tr>
<td class="address-1"><span id="24822"></span>24822</td>
<td class="instruction">JP <a href="24576.html#24670">24670</a></td>
<td class="comment-1" rowspan="1">Fill in the rightmost column</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="24699.html">24699</a>
</td>
<td class="up">Up: <a href="../maps/all.html#24731">Map</a></td>
<td class="next">
Next: <a href="24825.html">24825</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20191114</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2019 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.0.</div>
<div><a href="../../asm/609B.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>