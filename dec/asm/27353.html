<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 27353</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="27351.html">27351</a></span></td>
<td class="up">Up: <a href="../maps/all.html#27353">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="27387.html">27387</a></span></td>
</tr>
</table>
<div class="description">27353: Deal with  ERIC</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Called from the main loop at <a href="26471.html">26471</a>. Deals with ERIC when any of bits 0-4 at <a href="32763.html">32763</a> (ERIC's status flags) are set. Returns with the carry flag set if and only if ERIC was dealt with, indicating that there is no need to check keypresses in the main loop.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="27353"></span>27353</td>
<td class="bytes-0"></td>
<td class="instruction">CALL <a href="30636.html">30636</a></td>
<td class="comment-11" rowspan="1">Make any nearby teachers give ERIC lines if he's not where he should be, or standing or sitting when or where he shouldn't be</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27356"></span>27356</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,(32763)</td>
<td class="comment-11" rowspan="3">Check ERIC's status flags at <a href="32763.html">32763</a> and return with the carry flag reset unless ERIC has been knocked over, or he is firing, hitting, jumping, or being spoken to</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27359"></span>27359</td>
<td class="bytes-0"></td>
<td class="instruction">AND 31</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27361"></span>27361</td>
<td class="bytes-0"></td>
<td class="instruction">RET Z</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27362"></span>27362</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,27351</td>
<td class="comment-11" rowspan="2">After dealing with ERIC, return to the main loop via the routine at <a href="27351.html">27351</a> with the carry flag set to indicate that ERIC was dealt with</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27365"></span>27365</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27366"></span>27366</td>
<td class="bytes-0"></td>
<td class="instruction">BIT 3,A</td>
<td class="comment-11" rowspan="1">Is ERIC being spoken to by a little boy?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27368"></span>27368</td>
<td class="bytes-0"></td>
<td class="instruction">JP NZ,<a href="63352.html">63352</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27371"></span>27371</td>
<td class="bytes-0"></td>
<td class="instruction">CP 16</td>
<td class="comment-11" rowspan="1">Has ERIC been knocked over?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27373"></span>27373</td>
<td class="bytes-0"></td>
<td class="instruction">JP NC,<a href="27303.html">27303</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27376"></span>27376</td>
<td class="bytes-0"></td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Is ERIC firing a catapult?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27377"></span>27377</td>
<td class="bytes-0"></td>
<td class="instruction">JP Z,<a href="62495.html">62495</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27380"></span>27380</td>
<td class="bytes-0"></td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Is ERIC hitting?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27381"></span>27381</td>
<td class="bytes-0"></td>
<td class="instruction">JP Z,<a href="62628.html">62628</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="27384"></span>27384</td>
<td class="bytes-0"></td>
<td class="instruction">JP <a href="62771.html">62771</a></td>
<td class="comment-11" rowspan="1">ERIC is jumping; deal with him accordingly</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="27351.html">27351</a></span></td>
<td class="up">Up: <a href="../maps/all.html#27353">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="27387.html">27387</a></span></td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20190614</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2019 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 7.2.</div>
<div><a href="../../asm/6AD9.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>