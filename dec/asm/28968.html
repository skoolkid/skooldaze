<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 28968</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../../images/logo-dec.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="28960.html">28960</a>
</td>
<td class="up">Up: <a href="../maps/all.html#28968">Map</a></td>
<td class="next">
Next: <a href="28994.html">28994</a>
</td>
</tr>
</table>
<div class="description">28968: Get the identifier and coordinates of the blackboard closest to a character</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="28994.html">28994</a>, <a href="29148.html">29148</a>, <a href="29160.html">29160</a>, <a href="29284.html">29284</a>, <a href="32048.html">32048</a>, <a href="62208.html">62208</a>, <a href="63056.html">63056</a>, <a href="63146.html">63146</a> and <a href="64016.html">64016</a>. Returns with <span class="register">A</span> holding the blackboard identifier (the LSB of <a href="32748.html">32748</a>, <a href="32750.html">32750</a> or <a href="32752.html">32752</a>) and <span class="register">DE</span> holding the coordinates:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">A</th>
<th colspan="1" rowspan="1">(D,E)</th>
<th colspan="1" rowspan="1">Description</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1">236</td>
<td class="" colspan="1" rowspan="1">(155,42)</td>
<td class="" colspan="1" rowspan="1">Reading Room blackboard</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1">238</td>
<td class="" colspan="1" rowspan="1">(161,26)</td>
<td class="" colspan="1" rowspan="1">White Room blackboard</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1">240</td>
<td class="" colspan="1" rowspan="1">(161,41)</td>
<td class="" colspan="1" rowspan="1">Exam Room blackboard</td>
</tr>
</table>
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">Character number (163-167)</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="address-2"><span id="28968"></span>28968</td>
<td class="instruction">LD L,97</td>
<td class="comment-1" rowspan="1">Byte 97 of the character's buffer holds his y-coordinate</td>
</tr>
<tr>
<td class="address-1"><span id="28970"></span>28970</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1">Pick this up in <span class="register">A</span></td>
</tr>
<tr>
<td class="address-1"><span id="28971"></span>28971</td>
<td class="instruction">LD DE,39722</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=155 (y-coordinate), <span class="register">E</span>=42 (x-coordinate)</td>
</tr>
<tr>
<td class="address-1"><span id="28974"></span>28974</td>
<td class="instruction">CP 160</td>
<td class="comment-1" rowspan="1">Set the carry flag if the character's on the top floor</td>
</tr>
<tr>
<td class="address-1"><span id="28976"></span>28976</td>
<td class="instruction">LD A,236</td>
<td class="comment-1" rowspan="1">236=Reading Room blackboard</td>
</tr>
<tr>
<td class="address-1"><span id="28978"></span>28978</td>
<td class="instruction">RET C</td>
<td class="comment-1" rowspan="1">Return if the character's on the top floor</td>
</tr>
<tr>
<td class="address-1"><span id="28979"></span>28979</td>
<td class="instruction">INC L</td>
<td class="comment-1" rowspan="1"><span class="register">L</span>=98</td>
</tr>
<tr>
<td class="address-1"><span id="28980"></span>28980</td>
<td class="instruction">LD DE,41242</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=161 (y-coordinate), <span class="register">E</span>=26 (x-coordinate)</td>
</tr>
<tr>
<td class="address-1"><span id="28983"></span>28983</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=character's x-coordinate</td>
</tr>
<tr>
<td class="address-1"><span id="28984"></span>28984</td>
<td class="instruction">CP 37</td>
<td class="comment-1" rowspan="1">This is the x-coordinate of the wall between the White and Exam Rooms</td>
</tr>
<tr>
<td class="address-1"><span id="28986"></span>28986</td>
<td class="instruction">LD A,238</td>
<td class="comment-1" rowspan="1">238=White Room blackboard</td>
</tr>
<tr>
<td class="address-1"><span id="28988"></span>28988</td>
<td class="instruction">RET C</td>
<td class="comment-1" rowspan="1">Return if the character's to the left of the wall between the White and Exam Rooms</td>
</tr>
<tr>
<td class="address-1"><span id="28989"></span>28989</td>
<td class="instruction">LD E,41</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=161 (y-coordinate), <span class="register">E</span>=41 (x-coordinate)</td>
</tr>
<tr>
<td class="address-1"><span id="28991"></span>28991</td>
<td class="instruction">LD A,240</td>
<td class="comment-1" rowspan="1">240=Exam Room blackboard</td>
</tr>
<tr>
<td class="address-1"><span id="28993"></span>28993</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="28960.html">28960</a>
</td>
<td class="up">Up: <a href="../maps/all.html#28968">Map</a></td>
<td class="next">
Next: <a href="28994.html">28994</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20200809</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2020 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.2.</div>
<div><a href="../../asm/7128.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>