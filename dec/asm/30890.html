<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 30890</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="30888.html">30888</a></span></td>
<td class="up">Up: <a href="../maps/all.html#30890">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="31034.html">31034</a></span></td>
</tr>
</table>
<div class="description">30890: Make a teacher give lines to the closest main kid</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="27196.html">27196</a>. Makes a teacher who has been knocked over give lines to the closest main kid (if any).
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">Teacher's character number (163-166)</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30890"></span>30890</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30891"></span>30891</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,(32763)</td>
<td class="comment-11" rowspan="1">Copy ERIC's status flags from <a href="32763.html">32763</a> to <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30894"></span>30894</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,44130</td>
<td class="comment-11" rowspan="4">Pick up ERIC's coordinates in <span class="register">DE</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30897"></span>30897</td>
<td class="bytes-0"></td>
<td class="instruction">LD E,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30898"></span>30898</td>
<td class="bytes-0"></td>
<td class="instruction">DEC L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30899"></span>30899</td>
<td class="bytes-0"></td>
<td class="instruction">LD D,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30900"></span>30900</td>
<td class="bytes-0"></td>
<td class="instruction">LD BC,910</td>
<td class="comment-11" rowspan="1"><span class="register">B</span>=3 (number of main kids besides ERIC), <span class="register">C</span>=LSB of <a href="32652.html#32654">32654</a></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30903"></span>30903</td>
<td class="bytes-0"></td>
<td class="instruction">BIT 2,A</td>
<td class="comment-11" rowspan="1">Is ERIC jumping?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30905"></span>30905</td>
<td class="bytes-0"></td>
<td class="instruction">JR Z,30924</td>
<td class="comment-11" rowspan="1">Jump if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30907"></span>30907</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,D</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=ERIC's y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30908"></span>30908</td>
<td class="bytes-0"></td>
<td class="instruction">LD D,155</td>
<td class="comment-11" rowspan="1">This is the y-coordinate of the top floor</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30910"></span>30910</td>
<td class="bytes-0"></td>
<td class="instruction">CP 156</td>
<td class="comment-11" rowspan="1">Is ERIC jumping on the top floor?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30912"></span>30912</td>
<td class="bytes-0"></td>
<td class="instruction">JR C,30927</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30914"></span>30914</td>
<td class="bytes-0"></td>
<td class="instruction">LD D,162</td>
<td class="comment-11" rowspan="1">This is the y-coordinate of the middle floor</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30916"></span>30916</td>
<td class="bytes-0"></td>
<td class="instruction">CP 163</td>
<td class="comment-11" rowspan="1">Is ERIC jumping on the middle floor?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30918"></span>30918</td>
<td class="bytes-0"></td>
<td class="instruction">JR C,30927</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30920"></span>30920</td>
<td class="bytes-0"></td>
<td class="instruction">LD D,169</td>
<td class="comment-11" rowspan="1">This is the y-coordinate of the bottom floor</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30922"></span>30922</td>
<td class="bytes-0"></td>
<td class="instruction">JR 30927</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30924"></span>30924</td>
<td class="bytes-0"></td>
<td class="instruction">CALL <a href="28304.html#28310">28310</a></td>
<td class="comment-11" rowspan="1">Get the floor nearest ERIC (155, 162, 169) in <span class="register">D</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30927"></span>30927</td>
<td class="bytes-0"></td>
<td class="instruction">LD (32652),DE</td>
<td class="comment-11" rowspan="1">Store ERIC's normalised coordinates in <a href="32652.html">32652</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="30931"></span>
<div class="comments">
<div class="paragraph">
Here we enter a loop that calculates BOY WANDER's, ANGELFACE's and EINSTEIN's normalised coordinates and stores them in <a href="32652.html#32654">32654</a>, <a href="32652.html#32656">32656</a> and <a href="32652.html#32658">32658</a> respectively. (If a character's coordinates are (x, y), then his normalised coordinates are (x, Y), where Y=155, 162, 169, i.e. the y-coordinate of the floor he is closest to.)
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30931"></span>30931</td>
<td class="bytes-0"></td>
<td class="instruction">LD H,167</td>
<td class="comment-11" rowspan="1">167=BOY WANDER</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30933"></span>30933</td>
<td class="bytes-0"></td>
<td class="instruction">CALL <a href="28304.html">28304</a></td>
<td class="comment-11" rowspan="1"><span class="register">D</span>=floor nearest the kid (155, 162, 169)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30936"></span>30936</td>
<td class="bytes-0"></td>
<td class="instruction">LD L,C</td>
<td class="comment-11" rowspan="1"><span class="register">L</span>=142, 144 or 146</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30937"></span>30937</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="1">Store the kid's character number in <span class="register">A</span> temporarily</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30938"></span>30938</td>
<td class="bytes-0"></td>
<td class="instruction">LD H,127</td>
<td class="comment-11" rowspan="1"><span class="register">HL</span>=<a href="32652.html#32654">32654</a>, <a href="32652.html#32656">32656</a> or <a href="32652.html#32658">32658</a></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30940"></span>30940</td>
<td class="bytes-0"></td>
<td class="instruction">LD (HL),E</td>
<td class="comment-11" rowspan="3">Store the kid's normalised coordinates here</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30941"></span>30941</td>
<td class="bytes-0"></td>
<td class="instruction">INC L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30942"></span>30942</td>
<td class="bytes-0"></td>
<td class="instruction">LD (HL),D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30943"></span>30943</td>
<td class="bytes-0"></td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at the next normalised coordinates slot</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30944"></span>30944</td>
<td class="bytes-0"></td>
<td class="instruction">LD C,L</td>
<td class="comment-11" rowspan="1">Save <span class="register">L</span> in <span class="register">C</span> temporarily</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30945"></span>30945</td>
<td class="bytes-0"></td>
<td class="instruction">LD H,A</td>
<td class="comment-11" rowspan="1">Restore the kid's character number (167-169) to <span class="register">H</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30946"></span>30946</td>
<td class="bytes-0"></td>
<td class="instruction">INC H</td>
<td class="comment-11" rowspan="1">Next kid</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30947"></span>30947</td>
<td class="bytes-0"></td>
<td class="instruction">DJNZ 30933</td>
<td class="comment-11" rowspan="1">Jump back until the three main kids have been done</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30949"></span>30949</td>
<td class="bytes-0"></td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="2">Restore the teacher's character number (163-166) to <span class="register">H</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30950"></span>30950</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30951"></span>30951</td>
<td class="bytes-0"></td>
<td class="instruction">LD L,98</td>
<td class="comment-11" rowspan="4">Pick up the teacher's coordinates in <span class="register">DE</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30953"></span>30953</td>
<td class="bytes-0"></td>
<td class="instruction">LD E,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30954"></span>30954</td>
<td class="bytes-0"></td>
<td class="instruction">DEC L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30955"></span>30955</td>
<td class="bytes-0"></td>
<td class="instruction">LD D,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30956"></span>30956</td>
<td class="bytes-0"></td>
<td class="instruction">CALL <a href="28327.html">28327</a></td>
<td class="comment-11" rowspan="1">Get the lower and upper limits of the teacher's visibility range in <span class="register">C</span> and <span class="register">B</span></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="30959"></span>
<div class="comments">
<div class="paragraph">
Now we enter a loop to calculate the distance of each main kid from the teacher.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30959"></span>30959</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,32659</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at EINSTEIN's normalised y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30962"></span>30962</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,4</td>
<td class="comment-11" rowspan="1">There are four main kids to check</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30964"></span>30964</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH AF</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30965"></span>30965</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Pick up a kid's normalised y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30966"></span>30966</td>
<td class="bytes-0"></td>
<td class="instruction">DEC HL</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at the kid's x-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30967"></span>30967</td>
<td class="bytes-0"></td>
<td class="instruction">CP D</td>
<td class="comment-11" rowspan="1">Compare the normalised y-coordinate with the teacher's y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30968"></span>30968</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=kid's x-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30969"></span>30969</td>
<td class="bytes-0"></td>
<td class="instruction">LD (HL),255</td>
<td class="comment-11" rowspan="1">Default assumption: kid and teacher are on different floors</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30971"></span>30971</td>
<td class="bytes-0"></td>
<td class="instruction">JR NZ,30987</td>
<td class="comment-11" rowspan="1">Jump unless the kid's normalised y-coordinate matches the teacher's y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30973"></span>30973</td>
<td class="bytes-0"></td>
<td class="instruction">CP B</td>
<td class="comment-11" rowspan="5">Jump forward if the teacher cannot see the kid</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30974"></span>30974</td>
<td class="bytes-0"></td>
<td class="instruction">JR Z,30978</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30976"></span>30976</td>
<td class="bytes-0"></td>
<td class="instruction">JR NC,30987</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30978"></span>30978</td>
<td class="bytes-0"></td>
<td class="instruction">CP C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30979"></span>30979</td>
<td class="bytes-0"></td>
<td class="instruction">JR C,30987</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30981"></span>30981</td>
<td class="bytes-0"></td>
<td class="instruction">SUB E</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=distance between the teacher and the kid (possibly &lt; 0)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30982"></span>30982</td>
<td class="bytes-0"></td>
<td class="instruction">JR NC,30986</td>
<td class="comment-11" rowspan="1">Jump if the kid is to the right of the teacher (<span class="register">A</span>&gt;=0)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30984"></span>30984</td>
<td class="bytes-0"></td>
<td class="instruction">NEG</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30986"></span>30986</td>
<td class="bytes-0"></td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="1">Store the absolute distance between the teacher and the kid (if they are close to each other)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30987"></span>30987</td>
<td class="bytes-0"></td>
<td class="instruction">DEC HL</td>
<td class="comment-11" rowspan="4">Point <span class="register">HL</span> at the normalised y-coordinate of the next main kid and jump back until all four have been checked</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30988"></span>30988</td>
<td class="bytes-0"></td>
<td class="instruction">POP AF</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30989"></span>30989</td>
<td class="bytes-0"></td>
<td class="instruction">DEC A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30990"></span>30990</td>
<td class="bytes-0"></td>
<td class="instruction">JR NZ,30964</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="30992"></span>
<div class="comments">
<div class="paragraph">
Finally, we enter a loop to determine which main kid (if any) is closest to the teacher.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30992"></span>30992</td>
<td class="bytes-0"></td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1"><span class="register">HL</span>=<a href="32652.html">32652</a> (holding ERIC's distance from the teacher)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30993"></span>30993</td>
<td class="bytes-0"></td>
<td class="instruction">LD B,4</td>
<td class="comment-11" rowspan="1">There are four main kids to consider</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30995"></span>30995</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,255</td>
<td class="comment-11" rowspan="1">255 was used to signal that the kid was not on the same floor as the teacher</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="30997"></span>30997</td>
<td class="bytes-0"></td>
<td class="instruction">CP (HL)</td>
<td class="comment-11" rowspan="6">When this loop is finished, <span class="register">A</span> will hold the distance between the teacher and the closest main kid (or 255 if none of the kids were nearby)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="30998"></span>30998</td>
<td class="bytes-0"></td>
<td class="instruction">JR C,31001</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31000"></span>31000</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="31001"></span>31001</td>
<td class="bytes-0"></td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31002"></span>31002</td>
<td class="bytes-0"></td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31003"></span>31003</td>
<td class="bytes-0"></td>
<td class="instruction">DJNZ 30997</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31005"></span>31005</td>
<td class="bytes-0"></td>
<td class="instruction">INC A</td>
<td class="comment-11" rowspan="1">Were any of the main kids close to the teacher?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31006"></span>31006</td>
<td class="bytes-0"></td>
<td class="instruction">JR NZ,31010</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31008"></span>31008</td>
<td class="bytes-0"></td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1">Restore the teacher's character number to <span class="register">H</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31009"></span>31009</td>
<td class="bytes-0"></td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="31010"></span>
<div class="comments">
<div class="paragraph">
So at least one of the main kids is within range. Which one will get lines?
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="31010"></span>31010</td>
<td class="bytes-0"></td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=distance between the teacher and the nearest kid</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31011"></span>31011</td>
<td class="bytes-0"></td>
<td class="instruction">LD L,140</td>
<td class="comment-11" rowspan="1"><span class="register">HL</span>=<a href="32652.html">32652</a> (holding ERIC's distance from the teacher)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31013"></span>31013</td>
<td class="bytes-0"></td>
<td class="instruction">INC D</td>
<td class="comment-11" rowspan="1"><span class="register">D</span>=teacher's y-coordinate + 1</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31014"></span>31014</td>
<td class="bytes-0"></td>
<td class="instruction">LD BC,2220</td>
<td class="comment-11" rowspan="1"><span class="register">B</span>=<a href="56704.html">8</a> (NOW DON'T DO IT AGAIN), <span class="register">C</span>=172 (ERIC)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31017"></span>31017</td>
<td class="bytes-0"></td>
<td class="instruction">CP (HL)</td>
<td class="comment-11" rowspan="1">Is ERIC closest to the teacher?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31018"></span>31018</td>
<td class="bytes-0"></td>
<td class="instruction">JR Z,31028</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31020"></span>31020</td>
<td class="bytes-0"></td>
<td class="instruction">LD C,166</td>
<td class="comment-11" rowspan="6">On exit from this loop, <span class="register">C</span> will hold 167 (BOY WANDER), 168 (ANGELFACE), or 169 (EINSTEIN)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="31022"></span>31022</td>
<td class="bytes-0"></td>
<td class="instruction">INC C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31023"></span>31023</td>
<td class="bytes-0"></td>
<td class="instruction">INC L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31024"></span>31024</td>
<td class="bytes-0"></td>
<td class="instruction">INC L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31025"></span>31025</td>
<td class="bytes-0"></td>
<td class="instruction">CP (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31026"></span>31026</td>
<td class="bytes-0"></td>
<td class="instruction">JR NZ,31022</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="31028"></span>31028</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,C</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=character number of the kid closest to the teacher</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31029"></span>31029</td>
<td class="bytes-0"></td>
<td class="instruction">CALL <a href="30464.html">30464</a></td>
<td class="comment-11" rowspan="1">Give lines to the kid who is closest to the teacher</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31032"></span>31032</td>
<td class="bytes-0"></td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1">Restore the teacher's character number to <span class="register">H</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="31033"></span>31033</td>
<td class="bytes-0"></td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="30888.html">30888</a></span></td>
<td class="up">Up: <a href="../maps/all.html#30890">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="31034.html">31034</a></span></td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20190614</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2019 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 7.2.</div>
<div><a href="../../asm/78AA.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>