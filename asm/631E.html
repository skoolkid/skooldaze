<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 631E</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="631D.html">631D</a></span></td>
<td class="up">Up: <a href="../maps/all.html#631e">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="633A.html">633A</a></span></td>
</tr>
</table>
<div class="description">631E: Check whether a signal has been raised</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="62D7.html">62D7</a> and <a href="7DA7.html">7DA7</a>. On entry, <span class="register">A</span> holds the event identifier, which will be one of:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">A</th>
<th colspan="1" rowspan="1">Description</th>
<th colspan="1" rowspan="1">Flags</th>
<th colspan="1" rowspan="1">Bit</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x00</td>
<td class="" colspan="1" rowspan="1">End of lesson/playtime</td>
<td class="" colspan="1" rowspan="1"><a href="7FC8.html">7FC8</a></td>
<td class="centre" colspan="1" rowspan="1">0</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x08</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the Map Room</td>
<td class="" colspan="1" rowspan="1"><a href="7FC9.html">7FC9</a></td>
<td class="centre" colspan="1" rowspan="1">0</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x09</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the Reading Room</td>
<td class="" colspan="1" rowspan="1"><a href="7FC9.html">7FC9</a></td>
<td class="centre" colspan="1" rowspan="1">1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x0A</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the Exam Room</td>
<td class="" colspan="1" rowspan="1"><a href="7FC9.html">7FC9</a></td>
<td class="centre" colspan="1" rowspan="1">2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x0B</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the White Room</td>
<td class="" colspan="1" rowspan="1"><a href="7FC9.html">7FC9</a></td>
<td class="centre" colspan="1" rowspan="1">3</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x10</td>
<td class="" colspan="1" rowspan="1">Little boy no. 1 is ready to stampede</td>
<td class="" colspan="1" rowspan="1"><a href="7FCA.html">7FCA</a></td>
<td class="centre" colspan="1" rowspan="1">0</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x11</td>
<td class="" colspan="1" rowspan="1">Little boy no. 1 is ready to stampede again</td>
<td class="" colspan="1" rowspan="1"><a href="7FCA.html">7FCA</a></td>
<td class="centre" colspan="1" rowspan="1">1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x1A</td>
<td class="" colspan="1" rowspan="1">EINSTEIN or BOY WANDER is ready</td>
<td class="" colspan="1" rowspan="1"><a href="7FCB.html">7FCB</a></td>
<td class="centre" colspan="1" rowspan="1">2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x1B</td>
<td class="" colspan="1" rowspan="1">MR WACKER is ready</td>
<td class="" colspan="1" rowspan="1"><a href="7FCB.html">7FCB</a></td>
<td class="centre" colspan="1" rowspan="1">3</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x1C</td>
<td class="" colspan="1" rowspan="1">ERIC has been told about EINSTEIN, BOY WANDER or ANGELFACE</td>
<td class="" colspan="1" rowspan="1"><a href="7FCB.html">7FCB</a></td>
<td class="centre" colspan="1" rowspan="1">4</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0x1D</td>
<td class="" colspan="1" rowspan="1">EINSTEIN has told MR WACKER what ERIC's up to, or ERIC has mumps</td>
<td class="" colspan="1" rowspan="1"><a href="7FCB.html">7FCB</a></td>
<td class="centre" colspan="1" rowspan="1">5</td>
</tr>
</table>
</div>
<div class="paragraph">
The routine returns with the zero flag reset if the corresponding signal has been raised.
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">Event ID from a command list</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="631e"></span>631E</td>
<td class="bytes-0"></td>
<td class="instruction">PUSH AF</td>
<td class="comment-11" rowspan="1">Save the event identifier briefly</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="631f"></span>631F</td>
<td class="bytes-0"></td>
<td class="instruction">AND $F8</td>
<td class="comment-11" rowspan="4">Keep only bits 3-7 (the byte index) and shift them into bits 0-4</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6321"></span>6321</td>
<td class="bytes-0"></td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6322"></span>6322</td>
<td class="bytes-0"></td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6323"></span>6323</td>
<td class="bytes-0"></td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6324"></span>6324</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,$C8</td>
<td class="comment-11" rowspan="2">Modify the LD A,(m) instruction at <a href="631E.html#6334">6334</a> below so that m is <a href="7FC8.html">7FC8</a>, <a href="7FC9.html">7FC9</a>, <a href="7FCA.html">7FCA</a> or <a href="7FCB.html">7FCB</a></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6326"></span>6326</td>
<td class="bytes-0"></td>
<td class="instruction">LD ($6335),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6329"></span>6329</td>
<td class="bytes-0"></td>
<td class="instruction">POP AF</td>
<td class="comment-11" rowspan="1">Restore the event identifier to <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="632a"></span>632A</td>
<td class="bytes-0"></td>
<td class="instruction">AND $07</td>
<td class="comment-11" rowspan="1">Keep only bits 0-2 (the bit index)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="632c"></span>632C</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,A</td>
<td class="comment-11" rowspan="5">Modify the BIT n,A instruction at <a href="631E.html#6337">6337</a> below so that n=<span class="register">A</span> (0-7)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="632d"></span>632D</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="632e"></span>632E</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="632f"></span>632F</td>
<td class="bytes-0"></td>
<td class="instruction">ADD A,$47</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6331"></span>6331</td>
<td class="bytes-0"></td>
<td class="instruction">LD ($6338),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6334"></span>6334</td>
<td class="bytes-0"></td>
<td class="instruction">LD A,($7FC8)</td>
<td class="comment-11" rowspan="1">Pick up the byte holding the signal flag for this event (the operand of this instruction is modified earlier in this routine)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6337"></span>6337</td>
<td class="bytes-0"></td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1">Reset the zero flag if the signal has been raised (this instruction is modified earlier in this routine to check the appropriate bit)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6339"></span>6339</td>
<td class="bytes-0"></td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="631D.html">631D</a></span></td>
<td class="up">Up: <a href="../maps/all.html#631e">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="633A.html">633A</a></span></td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20190614</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2019 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 7.2.</div>
<div><a href="../dec/asm/25374.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>