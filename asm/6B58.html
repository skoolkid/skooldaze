<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 6B58</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../images/logo-hex.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="6B54.html">6B54</a>
</td>
<td class="up">Up: <a href="../maps/all.html#6b58">Map</a></td>
<td class="next">
Next: <a href="6B78.html">6B78</a>
</td>
</tr>
</table>
<div class="description">6B58: Raise the signal for a certain event</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by command lists <a href="FB80.html">0x80</a>, <a href="FB9A.html">0x82</a>, <a href="FBB4.html">0x84</a>, <a href="FBCA.html">0x86</a>, <a href="FDB3.html">0xCC</a>, <a href="FAE6.html">0xD0</a>, <a href="FAF0.html">0xD2</a>, <a href="FB09.html">0xD4</a>, <a href="FB20.html">0xD6</a>, <a href="FB3A.html">0xD8</a> and <a href="FB55.html">0xDA</a>.
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">Character number (0x98-0xA9)</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="address-2"><span id="6b58"></span>6B58</td>
<td class="instruction">LD B,$C6</td>
<td class="comment-1" rowspan="1">0xC6 is the code for 'SET 0,(HL)'</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="6b5a"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="6B54.html">6B54</a> with <span class="register">B</span>=0x86 (the code for 'RES 0,(HL)').
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="6b5a"></span>6B5A</td>
<td class="instruction">CALL <a href="618C.html">$618C</a></td>
<td class="comment-1" rowspan="1">Get the event identifier (0x00-0x1D) from the command list</td>
</tr>
<tr>
<td class="address-1"><span id="6b5d"></span>6B5D</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="9">Point <span class="register">HL</span> at the appropriate signal flag holder (<a href="7FC8.html">7FC8</a>, <a href="7FC9.html">7FC9</a>, <a href="7FCA.html">7FCA</a> or <a href="7FCB.html">7FCB</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="6b5e"></span>6B5E</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="address-1"><span id="6b5f"></span>6B5F</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="address-1"><span id="6b60"></span>6B60</td>
<td class="instruction">LD C,A</td>
</tr>
<tr>
<td class="address-1"><span id="6b61"></span>6B61</td>
<td class="instruction">AND $1F</td>
</tr>
<tr>
<td class="address-1"><span id="6b63"></span>6B63</td>
<td class="instruction">ADD A,$C8</td>
</tr>
<tr>
<td class="address-1"><span id="6b65"></span>6B65</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="address-1"><span id="6b66"></span>6B66</td>
<td class="instruction">LD D,$7F</td>
</tr>
<tr>
<td class="address-1"><span id="6b68"></span>6B68</td>
<td class="instruction">EX DE,HL</td>
</tr>
<tr>
<td class="address-1"><span id="6b69"></span>6B69</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="6">Modify the instruction at <a href="6B58.html#6b72">6B72</a> below to 'SET n,(HL)' or 'RES n,(HL)' as appropriate</td>
</tr>
<tr>
<td class="address-1"><span id="6b6a"></span>6B6A</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="address-1"><span id="6b6b"></span>6B6B</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="address-1"><span id="6b6c"></span>6B6C</td>
<td class="instruction">AND $38</td>
</tr>
<tr>
<td class="address-1"><span id="6b6e"></span>6B6E</td>
<td class="instruction">ADD A,B</td>
</tr>
<tr>
<td class="address-1"><span id="6b6f"></span>6B6F</td>
<td class="instruction">LD ($6B73),A</td>
</tr>
<tr>
<td class="address-1"><span id="6b72"></span>6B72</td>
<td class="instruction">SET 0,(HL)</td>
<td class="comment-1" rowspan="1">Lower or raise the signal for the event; this instruction is modified immediately before execution so that it sets or resets the appropriate bit</td>
</tr>
<tr>
<td class="address-1"><span id="6b74"></span>6B74</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Restore the character number to <span class="register">H</span></td>
</tr>
<tr>
<td class="address-1"><span id="6b75"></span>6B75</td>
<td class="instruction">JP <a href="62A0.html#62a8">$62A8</a></td>
<td class="comment-1" rowspan="1">Move to the next command in the command list</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="6B54.html">6B54</a>
</td>
<td class="up">Up: <a href="../maps/all.html#6b58">Map</a></td>
<td class="next">
Next: <a href="6B78.html">6B78</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20210310</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2021 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.4.</div>
<div><a href="../dec/asm/27480.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>