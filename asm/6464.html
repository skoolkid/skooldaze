<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at 6464</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Skool Daze" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="645F.html">645F</a></span></td>
<td class="up">Up: <a href="../maps/all.html#6464">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="6495.html">6495</a></span></td>
</tr>
</table>
<div class="description">6464: Guide a character from the bottom floor to another floor</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="63BE.html">63BE</a> when the character under consideration is on the bottom floor but is destined for another floor.
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">BC</td>
<td class="register-desc"><a href="633C.html">633C</a></td>
</tr>
<tr>
<td class="register">E</td>
<td class="register-desc">Character's x-coordinate</td>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">Character number (0x98-0xA9)</td>
</tr>
<tr>
<td class="register">L</td>
<td class="register-desc">0x65</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="6464"></span>6464</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=destination y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6465"></span>6465</td>
<td class="instruction">CP $A2</td>
<td class="comment-11" rowspan="1">Set the zero flag if the character is going to the middle floor</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6467"></span>6467</td>
<td class="instruction">LD A,$26</td>
<td class="comment-11" rowspan="1">This is the x-coordinate of the wall between the White and Exam Rooms</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6469"></span>6469</td>
<td class="instruction">JR Z,$646D</td>
<td class="comment-11" rowspan="1">Jump if the character is going to the middle floor</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="646b"></span>646B</td>
<td class="instruction">LD A,$39</td>
<td class="comment-11" rowspan="1">This is the x-coordinate of the wall between the Map and Reading Rooms</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="646d"></span>646D</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="2">Set the carry flag if the character is destined for some place to the right of the wall referred to by <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="646e"></span>646E</td>
<td class="instruction">CP (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="646f"></span>646F</td>
<td class="instruction">LD A,$46</td>
<td class="comment-11" rowspan="1">This is the x-coordinate of the bottoms of the staircases at the right of the skool</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6471"></span>6471</td>
<td class="instruction">JR C,$6475</td>
<td class="comment-11" rowspan="1">Jump if the character must go to a staircase on the right</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6473"></span>6473</td>
<td class="instruction">LD A,$13</td>
<td class="comment-11" rowspan="1">This is the x-coordinate of the bottoms of the staircases at the left of the skool</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="6475"></span>6475</td>
<td class="instruction">CP E</td>
<td class="comment-11" rowspan="1">Is the character at the bottom of the staircase he must climb?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6476"></span>6476</td>
<td class="instruction">JP NZ,<a href="63BE.html#641b">$641B</a></td>
<td class="comment-11" rowspan="1">Jump if not (to send the character there)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6479"></span>6479</td>
<td class="instruction">LD L,$60</td>
<td class="comment-11" rowspan="1">Byte 0x60 of the character's buffer holds his animatory state</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="647b"></span>647B</td>
<td class="instruction">BIT 0,(HL)</td>
<td class="comment-11" rowspan="1">Is the character midstride?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="647d"></span>647D</td>
<td class="instruction">JP NZ,<a href="63BE.html#641b">$641B</a></td>
<td class="comment-11" rowspan="1">Jump if so (to finish the stride)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6480"></span>6480</td>
<td class="instruction">CP $30</td>
<td class="comment-11" rowspan="1">Is the character at the bottom of a staircase at the right of the skool?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6482"></span>6482</td>
<td class="instruction">JR NC,$648B</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6484"></span>6484</td>
<td class="instruction">BIT 7,(HL)</td>
<td class="comment-11" rowspan="1">Is the character facing right?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6486"></span>6486</td>
<td class="instruction">JP NZ,<a href="63BE.html#640f">$640F</a></td>
<td class="comment-11" rowspan="1">Turn him round if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6489"></span>6489</td>
<td class="instruction">JR $6490</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="648b"></span>648B</td>
<td class="instruction">BIT 7,(HL)</td>
<td class="comment-11" rowspan="1">Is the character facing left?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="648d"></span>648D</td>
<td class="instruction">JP Z,<a href="63BE.html#640f">$640F</a></td>
<td class="comment-11" rowspan="1">Turn him round if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="6490"></span>6490</td>
<td class="instruction">LD C,$8C</td>
<td class="comment-11" rowspan="2">Set <span class="register">BC</span>=<a href="638C.html">638C</a> (guide character up stairs) and place this interruptible subcommand routine address into bytes 0x69 and 0x6A of the character's buffer</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="6492"></span>6492</td>
<td class="instruction">JP <a href="63BE.html#6419">$6419</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="645F.html">645F</a></span></td>
<td class="up">Up: <a href="../maps/all.html#6464">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="6495.html">6495</a></span></td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze RAM disassembly 20181018</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd. &#169; 2018 Richard Dymond.</div>
<div class="created">Created using <a href="http://skoolkit.ca/">SkoolKit</a> 7.0.</div>
<div><a href="http://skoolkit.ca/disassemblies/skool_daze/asm/25700.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>