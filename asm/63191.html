<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Skool Daze: Routine at 63191</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../microsphere.css" />
<link rel="stylesheet" type="text/css" href="../skool.css" />
<link rel="stylesheet" type="text/css" href="../sd.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="63146.html">63146</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#63191">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="63231.html">63231</a></span></td>
</tr>
</table>
<div class="description">63191: Make MR CREAK reveal his safe combination letter if appropriate</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a class="link" href="32132.html">32132</a>. A teacher is standing at the doorway of a classroom, ready to tell the kids to sit down; this routine checks whether the teacher is MR CREAK, and if it is, makes him reveal his safe combination letter if his birth year has been written on the blackboard by ERIC, and ERIC has not yet opened the safe.
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">Teacher's character number (163-166)</td>
</tr>
<tr>
<td class="register">L</td>
<td class="register-desc">122</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="63191"></a>63191</td>
<td class="instruction">CALL <a class="link" href="63734.html">63734</a></td>
<td class="comment-11" rowspan="2">Return unless we're dealing with CREAK and ERIC has not yet opened the safe</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63194"></a>63194</td>
<td class="instruction">RET C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63195"></a>63195</td>
<td class="instruction">CALL <a class="link" href="64016.html">64016</a></td>
<td class="comment-11" rowspan="2">Return unless CREAK is near a blackboard last written on by ERIC</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63198"></a>63198</td>
<td class="instruction">RET NZ</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63199"></a>63199</td>
<td class="instruction">LD A,E</td>
<td class="comment-11" rowspan="2"><span class="register">A</span>=56 (Reading Room blackboard) or 58 (White Room blackboard)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63200"></a>63200</td>
<td class="instruction">SUB 181</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63202"></a>63202</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1">Save CREAK's character number</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63203"></a>63203</td>
<td class="instruction">LD L,A</td>
<td class="comment-11" rowspan="6"><span class="register">HL</span>=<a class="link" href="32680.html">32680</a> (Reading Room blackboard contents buffer) or <a class="link" href="32686.html">32686</a> (White Room blackboard contents buffer)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63204"></a>63204</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63205"></a>63205</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63206"></a>63206</td>
<td class="instruction">NOP</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63207"></a>63207</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63208"></a>63208</td>
<td class="instruction">LD H,D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="63209"></a>
<div class="comments">
<div class="paragraph">
Check whether CREAK's birth year has been written on the board.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63209"></a>63209</td>
<td class="instruction">LD E,155</td>
<td class="comment-11" rowspan="1"><span class="register">DE</span>=<a class="link" href="32667.html">32667</a> (which holds CREAK's year of birth)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63211"></a>63211</td>
<td class="instruction">LD B,4</td>
<td class="comment-11" rowspan="1">There are 4 digits in CREAK's year of birth</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="63213"></a>63213</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=digit from CREAK's year of birth</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63214"></a>63214</td>
<td class="instruction">INC E</td>
<td class="comment-11" rowspan="1">Move <span class="register">DE</span> along to the next digit</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63215"></a>63215</td>
<td class="instruction">CP (HL)</td>
<td class="comment-11" rowspan="1">Compare the digit with the character written on the board</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63216"></a>63216</td>
<td class="instruction">JR NZ,63226</td>
<td class="comment-11" rowspan="1">Jump if they don't match</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63218"></a>63218</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1">Move to the next character written on the board</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63219"></a>63219</td>
<td class="instruction">DJNZ 63213</td>
<td class="comment-11" rowspan="1">Jump back until all 4 digits have been checked</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="63221"></a>
<div class="comments">
<div class="paragraph">
The first four characters written on the board by ERIC match the digits in MR CREAK's year of birth.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63221"></a>63221</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1">Restore CREAK's character number (166) to <span class="register">H</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63222"></a>63222</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1">Save it again</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63223"></a>63223</td>
<td class="instruction">CALL <a class="link" href="63829.html#63856">63856</a></td>
<td class="comment-11" rowspan="1">Reveal CREAK's safe combination letter</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="63226"></a>63226</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1">Restore CREAK's character number (166) to <span class="register">H</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63227"></a>63227</td>
<td class="instruction">LD BC,61889</td>
<td class="comment-11" rowspan="1">Set <span class="register">BC</span> to <a class="link" href="61889.html">61889</a> (SILENCE! OR I'LL CANE THE LOT OF YOU) before returning</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="63230"></a>63230</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="63146.html">63146</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#63191">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="63231.html">63231</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Skool Daze RAM disassembly 20140614</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd (Skool Daze). &#169; 2014 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://pyskool.ca/?page_id=177">SkoolKit</a> 4.0.</div>
</div>
</body>
</html>